<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
  </style>
</head>
<body>
  <form onsubmit="newWord(event)">
    <label for="hint">Hint</label>
    <input type="text" id="hint">
    <label for="word">Word</label>
    <input type="text" id="word">
    <div style="display: flex; gap: 1rem;">
      <button type="submit">Save</button>
      <button type="reset">Clear</button>
    </div>
  </form>

  <script>
    const apiUrl = 'https://hangman-renatobmps.herokuapp.com/';
    // const apiUrl = 'http://localhost:3000/'
    function newWord(event) {
      event.preventDefault();
      const wordBatch = document.getElementById('word').value;
      const hint = document.getElementById('hint').value;

      wordBatch.split('#').forEach(word => {
        try {
          fetch(apiUrl + 'words', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              authorization: localStorage.getItem('token'),
            },
            body: JSON.stringify({
              word: word.toLowerCase(),
              hint: hint.toLowerCase(),
            }),
          }).then(async data => {
            const body = await data.json();
            if (data.status !== 201) throw new Error(body.error || data.statusText);
            document.getElementById('word').value = '';
            return body;
          }).catch(err => {
            throw new Error(err);
          })
        } catch (error) {
          console.error(err);
          return alert(err || 'Error!');
        }
      });
    }
  </script>
</body>
</html>
